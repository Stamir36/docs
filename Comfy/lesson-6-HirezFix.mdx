---
title: "Hi-Res Fix и Tiled VAE Decode в ComfyUI"
description: "Как делать Hi-Res Fix, использовать tiled-decode и почему это важно для работы с VRAM"
---

<Info>
В этом уроке вы научитесь делать Hi-Res Fix в ComfyUI, используя техники latent upscale и модельный апскейл. Также разберём, зачем нужен VAE Decode (Tiled) при работе с большими картинками.
</Info>

## Почему используем **VAE Decode (Tiled)**

При декодировании латентного изображения в VAE обычный способ может вызвать **Out of Memory** на видеокарте. ComfyUI автоматически переключается на tiled-decode, чтобы разделять изображение на части, обрабатывать их по очереди и тем самым экономить VRAM.

**Преимущества tiled-decode:**
- Позволяет декодировать изображения **больших размеров**, даже если обычный способ выдаёт ошибку.
- Лучшее расходование памяти: разбивает задачу на маленькие **тайлы** (по умолчанию 512×512).
- Производительно и безопасно при ограниченных ресурсах.

---

## Hi-Res Fix: что это и зачем

Hi-Res Fix — это техника создания изображений высокого разрешения через **двухэтапный процесс**:

1. Генерация в низком разрешении (512×512 или аналогично).
2. Апскейл в латентном пространстве или через Upscale-модель.
3. Второй запуск KSampler с небольшим denoise для доработки деталей.

Это помогает сохранить структуру изображения и избежать артефактов при прямой генерации на высоком разрешении.

Есть два метода:

| Метод               | Что делает                           | Особенности                         |
|--------------------|--------------------------------------|--------------------------------------|
| **Latent Upscale**     | Апскейлит латентный шум              | Изображение меняется незначительно   |
| **Upscale Model**      | Апскейлит в пиксельном пространстве  | Точное 1:1 соответствие, без деформаций |


##  Пример Hi-Res Fix Workflow

<Frame>
![Ноды с несколькими LoRA](/images/ComfyUI/IMG_011.png) 
</Frame>
1. Load Checkpoint → KSampler → Latent Image  
2. Latent Upscale → второй KSampler → VAE Decode (Tiled) → Preview/Save 
---

## Шаги по созданию Hi-Res Fix проекта

<Steps>
  <Step title="Сгенерируйте базовую картинку">
    Пройдите стандартный граф Text-to-Latent → KSampler → Latent Image.
  </Step>

  <Step title="Latent Upscale">
    Добавьте узел `Upscale Latent` и задайте нужное разрешение (2× или 4×).
  </Step>

  <Step title="Повторите KSampler">
    Новый KSampler с **пониженным `denoise`** (например, 0.3–0.5), чтобы «подчистить» детали.
  </Step>

  <Step title="VAE Decode (Tiled)">
    Включите узел `VAE Decode (Tiled)` и при больших разрешениях понижайте `tile_size`, если превышает VRAM.
  </Step>

  <Step title="Сохраните результат">
    Используйте `Preview Image` или `Save Image`, чтобы получить финал.
  </Step>
</Steps>

---

##  Почему это работает лучше, особенно с **Tiled Decode**

- **Экономия VRAM**: tiled-decode разбивает задачу на части, даёт возможность работать с 2048×2048 даже на скромных GPU.
- **Стабильность**: предотвращает падение workflow, если обычный VAE Decode не справляется.
- **Контроль качества**: второй KSampler с низким denoise допускает улучшение деталей без разрушения исходной композиции.

---

## Сравнение: обычная генерация и результат с Hi-Res Fix

Вот визуальный пример, где слева — обычная генерация, а справа — результат с применённым Hi-Res Fix. Сравните детали, резкость и качество текстур.

<Columns cols={2}>
  <Frame>
    <img src="/images/ComfyUI/Standart.png" alt="Обычная генерация" style={{ width: "100%" }} />
    <figcaption>Обычная генерация</figcaption>
  </Frame>

  <Frame>
    <img src="/images/ComfyUI/HiRezFix.png" alt="С Hi-Res Fix" style={{ width: "100%" }} />
    <figcaption>С Hi-Res Fix</figcaption>
  </Frame>
</Columns>

### Что видно на примере

- **Обычная генерация (слева):** детализация базовая, возможна потеря мелких элементов.
- **Hi-Res Fix (справа):** улучшены текстуры, плавность цветов, зрачки глаз — HiRes Fix действительно работает.

---

<Note>
Теперь вы можете применять Hi-Res Fix как эффективно, так и безопасно, даже при ограниченном VRAM. Tiled Decode — ваш помощник для больших изображений.
</Note>
